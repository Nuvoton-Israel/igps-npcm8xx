----------------------------------------------------------------------
 SPDX-License-Identifier: GPL-2.0                                     
 Copyright (c) 2010-2022 by Nuvoton Technology Corporation   
 All rights reserved       

 NPCM8XX (Arbel) A35 BootBlock Release Letter 
----------------------------------------------------------------------

# NPCM8XX bootBlock Package
Release Letter
Version: 00.02.00
Date:    May 2022


# PACKAGE CONTENTS
----------------
This package contains the following files/folders:
- Sources\Arbel_A35_BootBlock_RelLetter.txt           - This release letter
- Sources\sources\                                    - Main source files
- Sources\SWC_DEFS\                                   - definition source files
- Sources\SWC_HAL\                                    - HW drivers files
- Sources\Build.bat, clean.bat                        - Building batch files for Windows
- Sources\makefile                                    - makefile for Windows and Linux
- Sources\HowToBuild.txt                              - How to build description

Output Files:
- Images\arbel_a35_bootblock.elf                      - Output image elf
- Images\arbel_a35_bootblock.dat                      - Output image dat
- Images\arbel_a35_bootblock.bin                      - Output image bin
- Images\arbel_a35_bootblock.map                      - Output image map


# DESCRIPTION
-----------
This package contains the Nuvoton Arbel BootBlock for the NPCM8XX A35 main core.
This package is released in alpha quality.


# REQUIREMENTS
------------
Hardware:
- A Nuvoton NPCM8XX Z1 Silicon BMC device.


# INSTALLATION PROCEDURE
----------------------
After compilation (see HowToBuild.txt) program   deliverables\arbel_a35_bootblock.bin
to flash via the IGPS (https://github.com/Nuvoton-Israel/igps) or other means.


# ENHANCEMENTS
----------------
version 0.2.0     - May 25 2022
=============
- Clear notifications before bootblock finish.
- MC print depends on MC_CONFIG value, bit 5.
- Remove DQS output sweep.
- Modified Security setup based on validation results and new implementation scheme.
- Switch to -O2.
- Increase SPI frequency to 50MHz (was 20MHz).

# FIXED ISSUES
------------
- Update the setting of Read Latency after training based on main clock to avoid an ECC error in read after write.


# KNOWN ISSUES
------------
- None.

# HISTORY
----------------
version 0.1.9     - Apr. 4 2022
=============
- Remove GIC init. moved to BL31.
- Add trim_2 initial offset to header. For EVB it will be [0,0]. For SVB and A1 it will be [10, 0].
- add mc_sweep_debug in header. bitwise field to enable test sweep. 
- Secondary reset: fix issue: no re-training of DDR in secondary reset.
- IGPS 3.4.5 and above.

version 0.1.8     - Feb 14 2022
=============
- Add phase1,2 dlls_trim[1:3] and vref to header.
- Move bootblock to end of RAM2. secondary code is just at the top. stack is in the beginning.
- Secondary cores: avoid using stack , waiting in holding pen in end of RAM2. 
  Each is waiting for a separate SCRPAD (0xF0800E10, 0xF0800E14, 0xF0800E18, 0xF0800E1C).

version 0.1.7     - Dec 20 2021
=============
- Bug fix when settings both PLLs to same value, both use PLL1 
  while PLL0 is disabled. Fix: leave PLL0 enabled for modules still using it 
  (efect: CLKSEL_RCPCKSEL, CLKSEL_RGSEL, CLKSEL_AHB6SSEL).
- Use  SCRPAD_10_41(2) and (3) to get the jump address from the TIP.
- DQS override: set the value w\o setting the override bit (which makes the training fail).
- Later enable the override bit after leveling and before DQs sweep.
- Dump mem regions for BL31, Tee and uboot (addresses hard coded).
- Only works with IGPS 3.3.3 and above.
- Shorten the memory test.
- Add ECC priority.
- Zero all dram.
- trap handler: print all ARM registers.


version 0.1.5     - Oct 22 2021
=============
- Changed reference to MC frequency to enum.
- Added PHI parameter calculation based on specification and modified parameter setting accordingly
- Update the setting of Read Latency after training based on main clock to avoid an ECC error in read after write
- Add header fields to override DQS in\out and dlls_trim. Require IGPS 3.3.2 and above.


version 0.1.4     - Oct 6 2021
=============
- Move SMP register to 0xF0800E00 (SCRPAD_10 + SCRPAD_11 are now used and written by Linux).
- Change UART to be UART0 only.
- Print to SPI-X address 0 value 0xAA. For debug.

# FIXED ISSUES
------------
- None.


# KNOWN ISSUES
------------
- None.


# HISTORY
-------------------
version 0.1.4     - Oct 6 2021
=============
- Move SMP register to 0xF0800E00 (SCRPAD_10(0) + SCRPAD_11(0) are now used and written by Linux).
- Change UART to be UART0 only.
- Print to SPI-X address 0 value 0xAA. For debug.

version 0.1.3     - Sept 22 2021
=============
- First open source release. 

version 0.1.2     - Sep 13 2021
=============
- Improved support for setting delay values for CS/DQ and Clock
- Support UNQ additional flows steps and settings
- fixed bugs in the setting of DLL_PHY_RECALIB counter
- Fixed values timeouts of MC TYPE0 TYPE1 recalibration
- Improved PHY logging

version 0.1.1     - Aug 26 2021
=============
- Added support for setting delay values for CS/DQ and Clock
- set pre-defined values for delay for DQ and CS
version 0.1.0     - Aug 19 2021
=============
- Fixed non ECC regions field to be in 1MB resolution.
- Check if non ECC region exist in header if its End value is bigger than 0
  instead of Start value, since Start value can be 0
- Update AHBCKFI.AHB_CLK_FRQ according AHB frequency

version 0.0.9     - Aug 17 2021
=============
- When no ECC is used, don't set DENALI_CTL_129.DISABLE_RD_INTERLEAVE.
- Before initializing MC check also DENALI_CTL_0_START since MC might be reset
  by WD reset while INTCR2_MC_INIT is still set.
  
version 0.0.8     - Aug 1 2021
=============
- Bug fix: IRQ handler.
- Print error logs only from core 0.

version 0.0.5   - May 6th 2021
=============
- Clear MC interrupts.
- set cntfrq_el0 for all 4 cores.
- Add more MC clock options (1037MHz , 1050MHz).
- Print last reset.

version 0.0.4   - Apr. 22 2021
=============
- Stable on SVB, up to 900MHz. EVB up to 1200MHz.
- Enable CP image search and load in bootblock. In IGPS there is CP FW "hello world".
- Print all clocks and board type (from header).
- Verify uboot copy. 
- Skip setting host IF. 

version 0.0.3   - Apr. 13 2021
=============
- Stable on EVB, up to 1000MHz. Not stable on SVB.
- Bug fix clock settings from header.
- change header to include odt.

version 0.0.2   - Mar. 17 2021
=============
- Change UART settings according to strap5.

version 0.0.1
=============
- First release. DDR training MC frequency at 700MHz only. hard-coded. CPU frequency according to strap.



-----------------------------------------------------------
For contact information see "Contact Us" at www.nuvoton.com
-----------------------------------------------------------
